<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MansfieldMEMEisTOPG3000</title>
<meta name="description" content="Mansfield MEME is TOPG3000 â€” buy SOL, trade on Raydium, join the meme revolution." />
<style>
  /* Basic layout + theme */
  :root { --gold: #ffd700; --bg1: #000; --bg2: #ffd700; }
  html,body{height:100%; margin:0; font-family: "Courier New", monospace; background: linear-gradient(135deg, var(--bg1) 50%, var(--bg2) 50%); color:#f0f0f0; overflow-x:hidden;}
  h1{color:#ff00ff; text-align:center; font-size:2.6rem; margin:18px 0; text-shadow:2px 2px #000;}
  .foreground{position:relative; z-index:2; text-align:center; padding:10px 12px;}
  .contract{font-weight:bold; font-size:1.05rem; margin-bottom:8px;}
  .container{display:flex; flex-wrap:wrap; justify-content:center; gap:18px; align-items:flex-start; padding:12px;}
  .qr-box{background:#1e1e1e; border-radius:12px; padding:12px; width:220px; text-align:center; color:#fff;}
  .qr-box h3{margin:0 0 8px 0; font-size:1rem;}
  .qr-box a, .qr-box button{display:block; text-decoration:none; color:#000; background:var(--gold); padding:8px; margin:6px auto; border-radius:6px; font-weight:700; cursor:pointer; width:90%;}
  .qr-box img{width:150px; height:150px; display:block; margin:8px auto 0 auto;}
  .token-text{color:#00ff00; font-weight:bold; max-width:680px; margin:18px auto; text-shadow:1px 1px #000; line-height:1.3;}
  /* floating fixed boxes positions for desktop */
  #walletConnectBox{position:fixed; top:20px; left:20px; z-index:30;}
  #phantomBuyBox{position:fixed; bottom:20px; right:20px; z-index:30;}
  @media(max-width:760px){
    #walletConnectBox,#phantomBuyBox{position:static; margin:auto;}
    h1{font-size:2rem;}
    .qr-box{width:90%;}
    .token-text{max-width:92%;}
  }

  /* fighter characters + avatars (absolute) */
  .character{position:absolute; font-size:2.6rem; animation:moveBackForth 3.5s infinite alternate; z-index:1;}
  @keyframes moveBackForth {0%{transform:translateX(0) rotate(-12deg)}25%{transform:translateX(150px) rotate(12deg)}50%{transform:translateX(0) rotate(-12deg)}75%{transform:translateX(-150px) rotate(12deg)}100%{transform:translateX(0) rotate(0)}}
  .avatar{position:absolute; width:140px; height:140px; object-fit:cover; border:2px solid #ff00ff; border-radius:10px; animation:bounce 4s infinite alternate; z-index:1;}
  @keyframes bounce {0%{transform:translateY(0) rotate(-5deg)}50%{transform:translateY(-40px) rotate(5deg)}100%{transform:translateY(0) rotate(-5deg)}}

  /* glowing buy box */
  #phantomBuyBox .qr-box { animation: glow 2s infinite ease-in-out; }
  @keyframes glow {0%{box-shadow:0 0 10px #ffd700; transform:scale(1)}50%{box-shadow:0 0 25px #ffef8a; transform:scale(1.03)}100%{box-shadow:0 0 10px #ffd700; transform:scale(1)}}

  /* Modal overlay (payment modal/qr) */
  .modal-overlay{position:fixed; inset:0; background:rgba(0,0,0,0.6); display:none; align-items:center; justify-content:center; z-index:100;}
  .modal{background:#111; border-radius:12px; padding:18px; text-align:center; color:#fff; max-width:360px; width:90%;}
  .modal h3{margin:0 0 8px 0;}
  .modal .close{position:absolute; right:14px; top:10px; background:transparent; border:0; color:#fff; font-size:1.4rem; cursor:pointer;}
  .modal img{width:220px; height:220px; margin:8px auto;}
  .modal .note{font-size:0.9rem; color:#ccc; margin-top:6px;}
</style>
</head>
<body>

<h1>MansfieldMEMEisTOPG3000</h1>

<!-- animated characters -->
<div class="character" style="top:100px; left:40px;">ðŸ¥‹</div>
<div class="character" style="top:260px; left:220px; animation-duration:4s;">ðŸ‘Š</div>
<div class="character" style="top:420px; left:420px; animation-duration:5s;">ðŸ’¥</div>

<!-- CryptoPunks avatars -->
<img src="https://www.larvalabs.com/cryptopunks/cryptopunk1234.png" class="avatar" style="top:50px; left:600px;">
<img src="https://www.larvalabs.com/cryptopunks/cryptopunk5678.png" class="avatar" style="top:300px; left:700px; animation-duration:5s;">
<img src="https://www.larvalabs.com/cryptopunks/cryptopunk9012.png" class="avatar" style="top:520px; left:50px; animation-duration:6s;">

<div class="foreground">
  <div class="contract">Contract Address: <strong>B2UTCkP2aErWowwwkNt8HAhMQ8Q9QqrJGKCb5t55cooB</strong></div>

  <div class="container">
    <!-- Raydium swap correct link + qr -->
    <div class="qr-box" id="raydiumBox">
      <h3>Trade TOPG on Raydium</h3>
      <a id="raydiumLink" href="https://raydium.io/swap/?inputMint=sol&outputMint=B2UTCkP2aErWowwwkNt8HAhMQ8Q9QqrJGKCb5t55cooB&referrer=BksFTNiEpv1Cddv9RBMjQk2yaN6f6BAL73hTNsxdT9mE"
         target="_blank">Go to Raydium</a>
      <img id="raydiumQR" src="https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=https://raydium.io/swap/?inputMint=sol&outputMint=B2UTCkP2aErWowwwkNt8HAhMQ8Q9QqrJGKCb5t55cooB&referrer=BksFTNiEpv1Cddv9RBMjQk2yaN6f6BAL73hTNsxdT9mE"
           alt="Raydium QR">
    </div>

    <!-- Phantom download -->
    <div class="qr-box">
      <h3>Download Phantom</h3>
      <a href="https://phantom.app/" target="_blank">Download</a>
      <img src="https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=https://phantom.app/" alt="Phantom Download QR">
    </div>

    <!-- WalletConnect floating box (top-left on desktop via CSS id) -->
    <div class="qr-box" id="walletConnectBox">
      <h3>WalletConnect (mobile / other wallets)</h3>
      <button id="connectWC">Connect WalletConnect</button>
      <button id="disconnectWC" style="display:none;">Disconnect</button>
      <p id="wcStatus" style="font-size:0.9rem;color:#ddd;margin:6px 0 0 0;"></p>
      <small style="display:block;color:#bbb;margin-top:8px;">Press Connect then approve in your mobile wallet. To pay 1 SOL, use the Pay button below.</small>
      <button id="wcPayBtn" style="background:#ffd700;color:#000;margin-top:8px;">Pay 1 SOL (WalletConnect)</button>
    </div>

    <!-- Phantom Buy TOPG (glowing) -->
    <div class="qr-box" id="phantomBuyBox">
      <h3>Buy TOPG â€” Send 1 SOL</h3>
      <!-- we'll use the deep-send endpoint with lamports so wallets prefill send -->
      <!-- lamports = 1 * 1_000_000_000 -->
      <a id="phantomOpenLink" href="https://phantom.app/ul/v1/send?recipient=BksFTNiEpv1Cddv9RBMjQk2yaN6f6BAL73hTNsxdT9mE&amount=1000000000&reference=MansfieldMEME&token=SOL&network=mainnet-beta" target="_blank">Open Phantom & Send</a>
      <img id="phantomQR" src="https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=https://phantom.app/ul/v1/send?recipient=BksFTNiEpv1Cddv9RBMjQk2yaN6f6BAL73hTNsxdT9mE&amount=1000000000&reference=MansfieldMEME&token=SOL&network=mainnet-beta"
           alt="Phantom Send 1 SOL QR">
      <div style="margin-top:8px;">
        <small style="color:#ccc">Label: <strong>BUY TOPG</strong></small>
      </div>
    </div>
  </div>

  <p class="token-text">
    Why did the poorest town of Old Manfield start mining memes? Because they said laughter pays
    better than gold. Think poor stay poor. Introducing MansfieldMEMEisTOPGâ€”the worldâ€™s worst
    meme coin. Powered by forgotten GIFs, cursed Vines, and pure optimism. Price only goes upâ€¦
    in spirit, if not in your wallet. Old Memetics: where broke meets blockchain hilarity.
  </p>
</div>

<!-- payment modal (custom) -->
<div id="paymentModal" class="modal-overlay" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <button class="close" id="modalClose" title="Close">âœ–</button>
    <h3 id="modalTitle">Pay 1 SOL â€” Scan or Open</h3>
    <!-- QR image will be set dynamically to ensure proper encoding -->
    <img id="modalQR" src="" alt="Payment QR">
    <div style="margin-top:8px;">
      <a id="modalOpenLink" href="#" target="_blank" style="display:inline-block;background:var(--gold);color:#000;border-radius:6px;padding:8px 12px;font-weight:700;text-decoration:none;">Open in Wallet</a>
    </div>
    <p class="note">If your wallet doesn't open, scan the QR with a phone wallet (Phantom recommended).</p>
  </div>
</div>

<!-- libs -->
<script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider/dist/umd/index.min.js"></script>

<script>
/* ====== Config (your addresses) ====== */
const SOL_ADDRESS = "BksFTNiEpv1Cddv9RBMjQk2yaN6f6BAL73hTNsxdT9mE";
const RAYDIUM_SWAP_URL = "https://raydium.io/swap/?inputMint=sol&outputMint=B2UTCkP2aErWowwwkNt8HAhMQ8Q9QqrJGKCb5t55cooB&referrer=BksFTNiEpv1Cddv9RBMjQk2yaN6f6BAL73hTNsxdT9mE";

/* ====== Utility: solana URI (sol: scheme) and phantom deep link (ul/v1/send with lamports) ====== */
function solanaURI(address, amountSol, label){
  // simple sol: URI (amount in decimal SOL)
  const q = new URLSearchParams();
  if (amountSol) q.set('amount', String(amountSol));
  if (label) q.set('label', label);
  return `solana:${address}?${q.toString()}`;
}
function phantomDeepSend(address, lamports, label){
  // phantom internal v1/send expects amount in lamports
  const params = new URLSearchParams();
  params.set('recipient', address);
  params.set('amount', String(lamports));
  if (label) params.set('reference', label);
  params.set('token', 'SOL');
  params.set('network','mainnet-beta');
  return `https://phantom.app/ul/v1/send?${params.toString()}`;
}

/* ====== Modal management ====== */
const paymentModal = document.getElementById('paymentModal');
const modalQR = document.getElementById('modalQR');
const modalOpenLink = document.getElementById('modalOpenLink');
const modalClose = document.getElementById('modalClose');

function showPaymentModal(uriForQR, openHref) {
  // set QR using api.qrserver with encoded URI
  modalQR.src = "https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=" + encodeURIComponent(uriForQR);
  modalOpenLink.href = openHref;
  paymentModal.style.display = "flex";
  paymentModal.setAttribute('aria-hidden','false');
}
function closePaymentModal(){
  paymentModal.style.display = "none";
  paymentModal.setAttribute('aria-hidden','true');
}
modalClose.addEventListener('click', closePaymentModal);
paymentModal.addEventListener('click', (e)=>{
  if(e.target === paymentModal) closePaymentModal();
});
window.addEventListener('keydown', (e)=>{ if(e.key === "Escape") closePaymentModal(); });

/* ====== Fix Raydium QR exact matching (already set in HTML), ensure link consistency: ====== */
document.getElementById('raydiumLink').href = RAYDIUM_SWAP_URL;
document.getElementById('raydiumQR').src = "https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=" + encodeURIComponent(RAYDIUM_SWAP_URL);

/* ====== Phantom Buy TOPG (Open + QR) ====== */
// lamports = SOL * 1_000_000_000
const lamportsFor1Sol = 1000000000;
const phantomSendUrl = phantomDeepSend(SOL_ADDRESS, lamportsFor1Sol, "BUY TOPG");
document.getElementById('phantomOpenLink').href = phantomSendUrl;
document.getElementById('phantomQR').src = "https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=" + encodeURIComponent(phantomSendUrl);

/* ====== WalletConnect: disable provider auto-QR, implement connect/disconnect & custom payment modal ====== */
let wcProvider = null;
const wcStatus = document.getElementById('wcStatus');
const connectBtn = document.getElementById('connectWC');
const disconnectBtn = document.getElementById('disconnectWC');
const wcPayBtn = document.getElementById('wcPayBtn');

connectBtn.addEventListener('click', async () => {
  try {
    // qrcode:false prevents lib from opening its own big QR overlay
    const WalletConnectProvider = window.WalletConnectProvider.default;
    wcProvider = new WalletConnectProvider({
      infuraId: "demo", // replace with your infuraId if you want real provider
      qrcode: false
    });
    wcStatus.textContent = "Connecting...";
    await wcProvider.enable(); // this will attempt to connect (mobile wallets may connect via deep link)
    const provider = new ethers.providers.Web3Provider(wcProvider);
    const signer = provider.getSigner();
    const address = await signer.getAddress();
    wcStatus.textContent = `Connected: ${address.slice(0,10)}...`;
    connectBtn.style.display = 'none';
    disconnectBtn.style.display = 'inline-block';
  } catch (err) {
    wcStatus.textContent = "Error connecting: " + (err.message || err);
    // If connection failed (desktop), we can still show the payment modal QR for scanning
    // Show payment modal fallback (solana URI)
    const uri = solanaURI(SOL_ADDRESS, 1, "BUY TOPG");
    // Also include Phantom deep send as open link fallback
    showPaymentModal(uri, phantomSendUrl);
  }
});

// disconnect
disconnectBtn.addEventListener('click', async () => {
  if (wcProvider) {
    try { await wcProvider.disconnect(); } catch(e){}
    wcStatus.textContent = "Disconnected";
    connectBtn.style.display = 'inline-block';
    disconnectBtn.style.display = 'none';
  }
});

/* When user clicks WalletConnect Pay -> show same payment modal (solana uri + phantom fallback) */
wcPayBtn.addEventListener('click', () => {
  const solUri = solanaURI(SOL_ADDRESS, 1, "BUY TOPG");           // solana:... ?amount=1&label=BUY TOPG
  showPaymentModal(solUri, phantomSendUrl);
});

/* Also allow clicking Phantom QR or Open to show same modal (desktop convenience) */
document.getElementById('phantomQR').addEventListener('click', () => {
  showPaymentModal(phantomSendUrl, phantomSendUrl);
});
document.getElementById('phantomOpenLink').addEventListener('click', (e) => {
  // primary action already opens link; but we also open modal for scanning if user wants
  // allow default navigation, but also show modal on desktop
  if (window.innerWidth > 760) {
    e.preventDefault();
    showPaymentModal(phantomSendUrl, phantomSendUrl);
  }
});

/* Accessibility / cleanup on page unload */
window.addEventListener('beforeunload', async () => {
  if (wcProvider && wcProvider.disconnect) {
    try{ await wcProvider.disconnect(); } catch(e){}
  }
});
</script>
</body>
</html>
